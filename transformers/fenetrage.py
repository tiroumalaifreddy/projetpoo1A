from datetime import date as dt
from datetime import timedelta
from Data.Jeu_de_donnees import Jeu_de_donnees
from transformers.transformers import Transformers



class Fenetrage(Transformers):
    '''Définition d'un fenetrage'

    Attributes
    ----------
    date_debut : str
        première date qui encadre le fenetrage
    date_fin : str
        deuxième date qui encadre le fenetrage
    index_date : int
        index de la variable correspondant à la date dans le jeu de données

    Parameters
    ----------
    date_debut : str
        première date qui encadre le fenetrage
    date_fin : str
        deuxième date qui encadre le fenetrage
    index_date : int
        index de la variable correspondant à la date dans le jeu de données

    Examples
    --------
    >>> Table = Jeu_de_donnees(Conversion(folder = "/home/freddy/Downloads/", filename="donnees-hospitalieres-nouveaux-covid19-2021-03-03-17h03.csv").convert())
    >>> F1 = Fenetrage('2021-02-24', '2021-02-25', index_date=1).transform(Table)
    >>> F2 = Fenetrage('2021-02-23', '2021-02-23', index_date=1).transform(Table)
    >>> print(F1)
    [['dep', 'jour', 'incid_hosp', 'incid_rea', 'incid_dc', 'incid_rad'], ['01', '2021-02-24', '20', '3', '1', '15'], ['02', '2021-02-24', '22', '1', '1', '18'], ['03', '2021-02-24', '12', '3', '7', '15'], ['04', '2021-02-24', '13', '1', '1', '1'], ['05', '2021-02-24', '5', '0', '0', '5'], ['06', '2021-02-24', '45', '13', '6', '41'], ['07', '2021-02-24', '11', '1', '1', '7'], ['08', '2021-02-24', '1', '0', '0', '1'], ['09', '2021-02-24', '2', '1', '2', '2'], ['10', '2021-02-24', '7', '1', '0', '4'], ['11', '2021-02-24', '1', '0', '0', '1'], ['12', '2021-02-24', '4', '0', '1', '0'], ['13', '2021-02-24', '93', '16', '20', '84'], ['14', '2021-02-24', '15', '4', '4', '10'], ['15', '2021-02-24', '1', '1', '0', '5'], ['16', '2021-02-24', '1', '0', '0', '0'], ['17', '2021-02-24', '3', '2', '0', '6'], ['18', '2021-02-24', '1', '0', '0', '3'], ['19', '2021-02-24', '6', '1', '0', '13'], ['21', '2021-02-24', '12', '3', '4', '30'], ['22', '2021-02-24', '8', '0', '0', '6'], ['23', '2021-02-24', '3', '1', '0', '4'], ['24', '2021-02-24', '12', '0', '0', '6'], ['25', '2021-02-24', '10', '3', '1', '9'], ['26', '2021-02-24', '12', '1', '5', '13'], ['27', '2021-02-24', '14', '1', '1', '2'], ['28', '2021-02-24', '24', '7', '2', '7'], ['29', '2021-02-24', '0', '0', '3', '6'], ['2A', '2021-02-24', '0', '1', '0', '0'], ['2B', '2021-02-24', '3', '2', '0', '5'], ['30', '2021-02-24', '13', '4', '0', '10'], ['31', '2021-02-24', '15', '1', '8', '37'], ['32', '2021-02-24', '1', '0', '0', '0'], ['33', '2021-02-24', '16', '1', '2', '11'], ['34', '2021-02-24', '15', '2', '5', '12'], ['35', '2021-02-24', '16', '3', '3', '34'], ['36', '2021-02-24', '18', '1', '1', '2'], ['37', '2021-02-24', '11', '0', '3', '3'], ['38', '2021-02-24', '40', '10', '4', '28'], ['39', '2021-02-24', '2', '1', '1', '9'], ['40', '2021-02-24', '1', '0', '0', '5'], ['41', '2021-02-24', '15', '2', '0', '7'], ['42', '2021-02-24', '10', '1', '3', '17'], ['43', '2021-02-24', '5', '0', '0', '0'], ['44', '2021-02-24', '15', '3', '4', '13'], ['45', '2021-02-24', '8', '6', '2', '21'], ['46', '2021-02-24', '2', '1', '0', '5'], ['47', '2021-02-24', '4', '1', '1', '2'], ['48', '2021-02-24', '0', '0', '0', '0'], ['49', '2021-02-24', '20', '1', '2', '17'], ['50', '2021-02-24', '2', '0', '3', '6'], ['51', '2021-02-24', '6', '2', '1', '7'], ['52', '2021-02-24', '8', '0', '2', '9'], ['53', '2021-02-24', '3', '0', '0', '3'], ['54', '2021-02-24', '13', '3', '2', '7'], ['55', '2021-02-24', '3', '0', '0', '2'], ['56', '2021-02-24', '20', '1', '4', '24'], ['57', '2021-02-24', '29', '3', '4', '10'], ['58', '2021-02-24', '4', '0', '2', '5'], ['59', '2021-02-24', '118', '24', '9', '44'], ['60', '2021-02-24', '29', '5', '3', '12'], ['61', '2021-02-24', '3', '0', '2', '4'], ['62', '2021-02-24', '58', '14', '12', '42'], ['63', '2021-02-24', '11', '1', '5', '17'], ['64', '2021-02-24', '5', '0', '2', '5'], ['65', '2021-02-24', '4', '1', '0', '1'], ['66', '2021-02-24', '6', '0', '2', '12'], ['67', '2021-02-24', '18', '5', '3', '17'], ['68', '2021-02-24', '7', '0', '5', '11'], ['69', '2021-02-24', '59', '7', '10', '38'], ['70', '2021-02-24', '4', '2', '1', '2'], ['71', '2021-02-24', '12', '4', '2', '18'], ['72', '2021-02-24', '8', '1', '1', '6'], ['73', '2021-02-24', '10', '1', '2', '15'], ['74', '2021-02-24', '8', '1', '6', '21'], ['75', '2021-02-24', '100', '35', '18', '74'], ['76', '2021-02-24', '27', '8', '4', '25'], ['77', '2021-02-24', '30', '7', '7', '34'], ['78', '2021-02-24', '27', '3', '12', '17'], ['79', '2021-02-24', '3', '1', '1', '5'], ['80', '2021-02-24', '18', '5', '5', '11'], ['81', '2021-02-24', '3', '0', '1', '14'], ['82', '2021-02-24', '2', '1', '0', '0'], ['83', '2021-02-24', '33', '8', '7', '39'], ['84', '2021-02-24', '38', '3', '3', '11'], ['85', '2021-02-24', '6', '0', '1', '2'], ['86', '2021-02-24', '2', '0', '0', '0'], ['87', '2021-02-24', '5', '1', '1', '7'], ['88', '2021-02-24', '12', '3', '0', '6'], ['89', '2021-02-24', '20', '1', '1', '7'], ['90', '2021-02-24', '3', '0', '1', '19'], ['91', '2021-02-24', '28', '5', '8', '33'], ['92', '2021-02-24', '52', '20', '8', '44'], ['93', '2021-02-24', '67', '10', '7', '78'], ['94', '2021-02-24', '52', '12', '4', '29'], ['95', '2021-02-24', '25', '2', '2', '26'], ['971', '2021-02-24', '2', '1', '0', '2'], ['972', '2021-02-24', '2', '0', '0', '3'], ['973', '2021-02-24', '2', '0', '2', '6'], ['974', '2021-02-24', '10', '4', '1', '6'], ['976', '2021-02-24', '31', '9', '2', '8'], ['01', '2021-02-25', '10', '5', '0', '5'], ['02', '2021-02-25', '38', '14', '6', '28'], ['03', '2021-02-25', '5', '2', '1', '9'], ['04', '2021-02-25', '4', '3', '3', '10'], ['05', '2021-02-25', '5', '1', '2', '4'], ['06', '2021-02-25', '50', '13', '13', '61'], ['07', '2021-02-25', '9', '0', '2', '6'], ['08', '2021-02-25', '3', '0', '0', '0'], ['09', '2021-02-25', '1', '0', '0', '4'], ['10', '2021-02-25', '1', '0', '0', '0'], ['11', '2021-02-25', '10', '0', '1', '6'], ['12', '2021-02-25', '1', '0', '1', '3'], ['13', '2021-02-25', '89', '19', '17', '116'], ['14', '2021-02-25', '8', '0', '0', '5'], ['15', '2021-02-25', '3', '0', '0', '3'], ['16', '2021-02-25', '8', '4', '0', '5'], ['17', '2021-02-25', '3', '0', '1', '4'], ['18', '2021-02-25', '8', '0', '3', '11'], ['19', '2021-02-25', '3', '0', '0', '2'], ['21', '2021-02-25', '7', '3', '1', '9'], ['22', '2021-02-25', '9', '0', '0', '4'], ['23', '2021-02-25', '1', '0', '0', '1'], ['24', '2021-02-25', '6', '0', '2', '6'], ['25', '2021-02-25', '3', '0', '0', '3'], ['26', '2021-02-25', '22', '2', '4', '13'], ['27', '2021-02-25', '14', '1', '2', '7'], ['28', '2021-02-25', '21', '3', '3', '16'], ['29', '2021-02-25', '1', '0', '0', '1'], ['2A', '2021-02-25', '2', '0', '0', '0'], ['2B', '2021-02-25', '0', '0', '1', '0'], ['30', '2021-02-25', '9', '1', '2', '11'], ['31', '2021-02-25', '19', '5', '2', '39'], ['32', '2021-02-25', '1', '1', '1', '20'], ['33', '2021-02-25', '9', '2', '6', '40'], ['34', '2021-02-25', '15', '5', '3', '8'], ['35', '2021-02-25', '15', '2', '3', '26'], ['36', '2021-02-25', '0', '0', '0', '0'], ['37', '2021-02-25', '17', '4', '0', '8'], ['38', '2021-02-25', '38', '6', '6', '28'], ['39', '2021-02-25', '2', '0', '0', '8'], ['40', '2021-02-25', '2', '0', '3', '4'], ['41', '2021-02-25', '18', '1', '7', '31'], ['42', '2021-02-25', '31', '10', '5', '31'], ['43', '2021-02-25', '2', '0', '1', '3'], ['44', '2021-02-25', '17', '2', '3', '27'], ['45', '2021-02-25', '13', '2', '4', '7'], ['46', '2021-02-25', '1', '1', '0', '0'], ['47', '2021-02-25', '0', '0', '0', '0'], ['48', '2021-02-25', '2', '0', '1', '5'], ['49', '2021-02-25', '9', '1', '3', '10'], ['50', '2021-02-25', '2', '0', '0', '4'], ['51', '2021-02-25', '8', '0', '1', '9'], ['52', '2021-02-25', '3', '0', '1', '5'], ['53', '2021-02-25', '7', '0', '0', '11'], ['54', '2021-02-25', '6', '4', '2', '9'], ['55', '2021-02-25', '5', '0', '2', '14'], ['56', '2021-02-25', '12', '2', '5', '9'], ['57', '2021-02-25', '55', '18', '14', '34'], ['58', '2021-02-25', '3', '0', '0', '5'], ['59', '2021-02-25', '84', '14', '8', '55'], ['60', '2021-02-25', '12', '5', '1', '23'], ['61', '2021-02-25', '3', '2', '2', '9'], ['62', '2021-02-25', '50', '11', '6', '40'], ['63', '2021-02-25', '5', '3', '6', '9'], ['64', '2021-02-25', '3', '1', '1', '5'], ['65', '2021-02-25', '11', '2', '0', '0'], ['66', '2021-02-25', '11', '1', '1', '3'], ['67', '2021-02-25', '15', '11', '0', '31'], ['68', '2021-02-25', '6', '1', '1', '18'], ['69', '2021-02-25', '53', '15', '11', '45'], ['70', '2021-02-25', '1', '1', '0', '5'], ['71', '2021-02-25', '12', '0', '3', '17'], ['72', '2021-02-25', '17', '0', '2', '8'], ['73', '2021-02-25', '2', '0', '0', '5'], ['74', '2021-02-25', '20', '2', '0', '18'], ['75', '2021-02-25', '68', '13', '14', '45'], ['76', '2021-02-25', '22', '4', '1', '17'], ['77', '2021-02-25', '21', '5', '9', '22'], ['78', '2021-02-25', '28', '2', '2', '21'], ['79', '2021-02-25', '4', '0', '0', '3'], ['80', '2021-02-25', '25', '5', '9', '21'], ['81', '2021-02-25', '4', '0', '0', '5'], ['82', '2021-02-25', '3', '2', '1', '4'], ['83', '2021-02-25', '49', '3', '10', '29'], ['84', '2021-02-25', '12', '2', '2', '12'], ['85', '2021-02-25', '4', '0', '0', '0'], ['86', '2021-02-25', '9', '2', '1', '14'], ['87', '2021-02-25', '1', '0', '0', '3'], ['88', '2021-02-25', '8', '3', '1', '15'], ['89', '2021-02-25', '10', '0', '1', '11'], ['90', '2021-02-25', '0', '0', '0', '0'], ['91', '2021-02-25', '32', '6', '6', '25'], ['92', '2021-02-25', '30', '13', '6', '40'], ['93', '2021-02-25', '34', '10', '1', '24'], ['94', '2021-02-25', '55', '14', '8', '45'], ['95', '2021-02-25', '33', '6', '5', '30'], ['971', '2021-02-25', '0', '0', '0', '2'], ['972', '2021-02-25', '0', '0', '0', '0'], ['973', '2021-02-25', '1', '0', '0', '3'], ['974', '2021-02-25', '8', '2', '0', '11'], ['976', '2021-02-25', '22', '3', '4', '3']]
    >>> print(F2)
    [['dep', 'jour', 'incid_hosp', 'incid_rea', 'incid_dc', 'incid_rad'], ['01', '2021-02-23', '15', '3', '3', '10'], ['02', '2021-02-23', '20', '1', '7', '15'], ['03', '2021-02-23', '6', '0', '5', '12'], ['04', '2021-02-23', '3', '0', '1', '10'], ['05', '2021-02-23', '7', '1', '0', '5'], ['06', '2021-02-23', '60', '17', '19', '58'], ['07', '2021-02-23', '14', '0', '4', '18'], ['08', '2021-02-23', '4', '2', '1', '4'], ['09', '2021-02-23', '2', '0', '0', '6'], ['10', '2021-02-23', '10', '3', '1', '6'], ['11', '2021-02-23', '11', '1', '2', '1'], ['12', '2021-02-23', '3', '1', '1', '0'], ['13', '2021-02-23', '93', '14', '9', '89'], ['14', '2021-02-23', '8', '1', '1', '7'], ['15', '2021-02-23', '1', '0', '1', '4'], ['16', '2021-02-23', '6', '0', '1', '3'], ['17', '2021-02-23', '1', '1', '0', '13'], ['18', '2021-02-23', '11', '1', '3', '11'], ['19', '2021-02-23', '5', '0', '1', '7'], ['21', '2021-02-23', '19', '2', '5', '26'], ['22', '2021-02-23', '4', '0', '2', '3'], ['23', '2021-02-23', '3', '1', '0', '4'], ['24', '2021-02-23', '5', '1', '4', '9'], ['25', '2021-02-23', '5', '2', '0', '10'], ['26', '2021-02-23', '27', '2', '6', '7'], ['27', '2021-02-23', '10', '2', '4', '6'], ['28', '2021-02-23', '21', '5', '6', '28'], ['29', '2021-02-23', '2', '0', '1', '4'], ['2A', '2021-02-23', '3', '0', '0', '0'], ['2B', '2021-02-23', '0', '0', '0', '0'], ['30', '2021-02-23', '7', '1', '2', '11'], ['31', '2021-02-23', '28', '2', '5', '18'], ['32', '2021-02-23', '2', '0', '0', '6'], ['33', '2021-02-23', '30', '7', '4', '20'], ['34', '2021-02-23', '29', '4', '2', '23'], ['35', '2021-02-23', '20', '3', '5', '13'], ['36', '2021-02-23', '0', '0', '0', '4'], ['37', '2021-02-23', '22', '6', '1', '22'], ['38', '2021-02-23', '30', '9', '5', '44'], ['39', '2021-02-23', '5', '0', '1', '6'], ['40', '2021-02-23', '1', '0', '0', '2'], ['41', '2021-02-23', '6', '2', '1', '5'], ['42', '2021-02-23', '13', '2', '4', '9'], ['43', '2021-02-23', '4', '1', '1', '5'], ['44', '2021-02-23', '15', '2', '3', '10'], ['45', '2021-02-23', '17', '7', '6', '11'], ['46', '2021-02-23', '1', '0', '1', '1'], ['47', '2021-02-23', '3', '2', '1', '14'], ['48', '2021-02-23', '2', '0', '0', '1'], ['49', '2021-02-23', '10', '4', '2', '6'], ['50', '2021-02-23', '6', '1', '4', '5'], ['51', '2021-02-23', '16', '1', '2', '13'], ['52', '2021-02-23', '3', '0', '0', '4'], ['53', '2021-02-23', '1', '0', '1', '5'], ['54', '2021-02-23', '14', '5', '3', '22'], ['55', '2021-02-23', '3', '1', '0', '3'], ['56', '2021-02-23', '8', '3', '1', '11'], ['57', '2021-02-23', '61', '8', '10', '35'], ['58', '2021-02-23', '4', '1', '0', '10'], ['59', '2021-02-23', '91', '22', '20', '81'], ['60', '2021-02-23', '22', '6', '5', '20'], ['61', '2021-02-23', '2', '0', '1', '10'], ['62', '2021-02-23', '84', '25', '9', '60'], ['63', '2021-02-23', '18', '4', '9', '20'], ['64', '2021-02-23', '3', '0', '0', '3'], ['65', '2021-02-23', '0', '1', '0', '2'], ['66', '2021-02-23', '5', '1', '1', '6'], ['67', '2021-02-23', '19', '5', '5', '27'], ['68', '2021-02-23', '12', '3', '3', '22'], ['69', '2021-02-23', '50', '15', '6', '42'], ['70', '2021-02-23', '4', '3', '0', '11'], ['71', '2021-02-23', '19', '3', '2', '13'], ['72', '2021-02-23', '12', '0', '2', '12'], ['73', '2021-02-23', '12', '0', '2', '7'], ['74', '2021-02-23', '20', '3', '1', '21'], ['75', '2021-02-23', '55', '22', '8', '47'], ['76', '2021-02-23', '33', '4', '2', '18'], ['77', '2021-02-23', '46', '14', '4', '28'], ['78', '2021-02-23', '31', '5', '3', '31'], ['79', '2021-02-23', '3', '0', '0', '4'], ['80', '2021-02-23', '9', '3', '3', '16'], ['81', '2021-02-23', '4', '1', '1', '10'], ['82', '2021-02-23', '4', '2', '0', '1'], ['83', '2021-02-23', '48', '4', '9', '49'], ['84', '2021-02-23', '40', '1', '3', '28'], ['85', '2021-02-23', '11', '0', '1', '6'], ['86', '2021-02-23', '7', '3', '0', '6'], ['87', '2021-02-23', '4', '0', '2', '4'], ['88', '2021-02-23', '14', '1', '3', '17'], ['89', '2021-02-23', '17', '1', '2', '5'], ['90', '2021-02-23', '8', '2', '0', '8'], ['91', '2021-02-23', '36', '1', '6', '17'], ['92', '2021-02-23', '71', '30', '18', '61'], ['93', '2021-02-23', '95', '13', '13', '60'], ['94', '2021-02-23', '66', '6', '12', '30'], ['95', '2021-02-23', '34', '3', '4', '32'], ['971', '2021-02-23', '5', '1', '0', '12'], ['972', '2021-02-23', '1', '0', '0', '1'], ['973', '2021-02-23', '2', '1', '0', '1'], ['974', '2021-02-23', '10', '3', '1', '4'], ['976', '2021-02-23', '13', '0', '0', '7']]
    '''

    def __init__(self, date_debut, date_fin, index_date = 0):
        '''Constructeur

        Parameters
        ----------
        date_debut : str
            première date qui encadre le fenetrage. Le format doit correspondre au format de la date associé au jeu de données.
        date_fin : str
            deuxième date qui encadre le fenetrage
        index_date : int
            index de la variable correspondant à la date dans le jeu de données


        '''
        self.date_debut = date_debut
        self.date_fin = date_fin
        self.index_date = index_date

    def transform(self, Table):
        '''Retourne un nouveau jeu de données mais avec comprenant uniquement les lignes appartenant à la période


        Parameters
        ----------
        Table : Jeu_de_donnees
            Jeu de données auquel on applique la transformation

        Returns
        -------
        Jeu_de_donnees
            Jeu_de_données qui a subi le fenetrage

        Examples
        ---------
        >>> Table = Jeu_de_donnees(Conversion(folder = "/home/freddy/Downloads/", filename="donnees-hospitalieres-nouveaux-covid19-2021-03-03-17h03.csv").convert())
        >>> F = Fenetrage('2021-02-24', '2021-02-25', index_date=1).transform(Table)
        >>> print(F)
        [['dep', 'jour', 'incid_hosp', 'incid_rea', 'incid_dc', 'incid_rad'], ['01', '2021-02-24', '20', '3', '1', '15'], ['02', '2021-02-24', '22', '1', '1', '18'], ['03', '2021-02-24', '12', '3', '7', '15'], ['04', '2021-02-24', '13', '1', '1', '1'], ['05', '2021-02-24', '5', '0', '0', '5'], ['06', '2021-02-24', '45', '13', '6', '41'], ['07', '2021-02-24', '11', '1', '1', '7'], ['08', '2021-02-24', '1', '0', '0', '1'], ['09', '2021-02-24', '2', '1', '2', '2'], ['10', '2021-02-24', '7', '1', '0', '4'], ['11', '2021-02-24', '1', '0', '0', '1'], ['12', '2021-02-24', '4', '0', '1', '0'], ['13', '2021-02-24', '93', '16', '20', '84'], ['14', '2021-02-24', '15', '4', '4', '10'], ['15', '2021-02-24', '1', '1', '0', '5'], ['16', '2021-02-24', '1', '0', '0', '0'], ['17', '2021-02-24', '3', '2', '0', '6'], ['18', '2021-02-24', '1', '0', '0', '3'], ['19', '2021-02-24', '6', '1', '0', '13'], ['21', '2021-02-24', '12', '3', '4', '30'], ['22', '2021-02-24', '8', '0', '0', '6'], ['23', '2021-02-24', '3', '1', '0', '4'], ['24', '2021-02-24', '12', '0', '0', '6'], ['25', '2021-02-24', '10', '3', '1', '9'], ['26', '2021-02-24', '12', '1', '5', '13'], ['27', '2021-02-24', '14', '1', '1', '2'], ['28', '2021-02-24', '24', '7', '2', '7'], ['29', '2021-02-24', '0', '0', '3', '6'], ['2A', '2021-02-24', '0', '1', '0', '0'], ['2B', '2021-02-24', '3', '2', '0', '5'], ['30', '2021-02-24', '13', '4', '0', '10'], ['31', '2021-02-24', '15', '1', '8', '37'], ['32', '2021-02-24', '1', '0', '0', '0'], ['33', '2021-02-24', '16', '1', '2', '11'], ['34', '2021-02-24', '15', '2', '5', '12'], ['35', '2021-02-24', '16', '3', '3', '34'], ['36', '2021-02-24', '18', '1', '1', '2'], ['37', '2021-02-24', '11', '0', '3', '3'], ['38', '2021-02-24', '40', '10', '4', '28'], ['39', '2021-02-24', '2', '1', '1', '9'], ['40', '2021-02-24', '1', '0', '0', '5'], ['41', '2021-02-24', '15', '2', '0', '7'], ['42', '2021-02-24', '10', '1', '3', '17'], ['43', '2021-02-24', '5', '0', '0', '0'], ['44', '2021-02-24', '15', '3', '4', '13'], ['45', '2021-02-24', '8', '6', '2', '21'], ['46', '2021-02-24', '2', '1', '0', '5'], ['47', '2021-02-24', '4', '1', '1', '2'], ['48', '2021-02-24', '0', '0', '0', '0'], ['49', '2021-02-24', '20', '1', '2', '17'], ['50', '2021-02-24', '2', '0', '3', '6'], ['51', '2021-02-24', '6', '2', '1', '7'], ['52', '2021-02-24', '8', '0', '2', '9'], ['53', '2021-02-24', '3', '0', '0', '3'], ['54', '2021-02-24', '13', '3', '2', '7'], ['55', '2021-02-24', '3', '0', '0', '2'], ['56', '2021-02-24', '20', '1', '4', '24'], ['57', '2021-02-24', '29', '3', '4', '10'], ['58', '2021-02-24', '4', '0', '2', '5'], ['59', '2021-02-24', '118', '24', '9', '44'], ['60', '2021-02-24', '29', '5', '3', '12'], ['61', '2021-02-24', '3', '0', '2', '4'], ['62', '2021-02-24', '58', '14', '12', '42'], ['63', '2021-02-24', '11', '1', '5', '17'], ['64', '2021-02-24', '5', '0', '2', '5'], ['65', '2021-02-24', '4', '1', '0', '1'], ['66', '2021-02-24', '6', '0', '2', '12'], ['67', '2021-02-24', '18', '5', '3', '17'], ['68', '2021-02-24', '7', '0', '5', '11'], ['69', '2021-02-24', '59', '7', '10', '38'], ['70', '2021-02-24', '4', '2', '1', '2'], ['71', '2021-02-24', '12', '4', '2', '18'], ['72', '2021-02-24', '8', '1', '1', '6'], ['73', '2021-02-24', '10', '1', '2', '15'], ['74', '2021-02-24', '8', '1', '6', '21'], ['75', '2021-02-24', '100', '35', '18', '74'], ['76', '2021-02-24', '27', '8', '4', '25'], ['77', '2021-02-24', '30', '7', '7', '34'], ['78', '2021-02-24', '27', '3', '12', '17'], ['79', '2021-02-24', '3', '1', '1', '5'], ['80', '2021-02-24', '18', '5', '5', '11'], ['81', '2021-02-24', '3', '0', '1', '14'], ['82', '2021-02-24', '2', '1', '0', '0'], ['83', '2021-02-24', '33', '8', '7', '39'], ['84', '2021-02-24', '38', '3', '3', '11'], ['85', '2021-02-24', '6', '0', '1', '2'], ['86', '2021-02-24', '2', '0', '0', '0'], ['87', '2021-02-24', '5', '1', '1', '7'], ['88', '2021-02-24', '12', '3', '0', '6'], ['89', '2021-02-24', '20', '1', '1', '7'], ['90', '2021-02-24', '3', '0', '1', '19'], ['91', '2021-02-24', '28', '5', '8', '33'], ['92', '2021-02-24', '52', '20', '8', '44'], ['93', '2021-02-24', '67', '10', '7', '78'], ['94', '2021-02-24', '52', '12', '4', '29'], ['95', '2021-02-24', '25', '2', '2', '26'], ['971', '2021-02-24', '2', '1', '0', '2'], ['972', '2021-02-24', '2', '0', '0', '3'], ['973', '2021-02-24', '2', '0', '2', '6'], ['974', '2021-02-24', '10', '4', '1', '6'], ['976', '2021-02-24', '31', '9', '2', '8'], ['01', '2021-02-25', '10', '5', '0', '5'], ['02', '2021-02-25', '38', '14', '6', '28'], ['03', '2021-02-25', '5', '2', '1', '9'], ['04', '2021-02-25', '4', '3', '3', '10'], ['05', '2021-02-25', '5', '1', '2', '4'], ['06', '2021-02-25', '50', '13', '13', '61'], ['07', '2021-02-25', '9', '0', '2', '6'], ['08', '2021-02-25', '3', '0', '0', '0'], ['09', '2021-02-25', '1', '0', '0', '4'], ['10', '2021-02-25', '1', '0', '0', '0'], ['11', '2021-02-25', '10', '0', '1', '6'], ['12', '2021-02-25', '1', '0', '1', '3'], ['13', '2021-02-25', '89', '19', '17', '116'], ['14', '2021-02-25', '8', '0', '0', '5'], ['15', '2021-02-25', '3', '0', '0', '3'], ['16', '2021-02-25', '8', '4', '0', '5'], ['17', '2021-02-25', '3', '0', '1', '4'], ['18', '2021-02-25', '8', '0', '3', '11'], ['19', '2021-02-25', '3', '0', '0', '2'], ['21', '2021-02-25', '7', '3', '1', '9'], ['22', '2021-02-25', '9', '0', '0', '4'], ['23', '2021-02-25', '1', '0', '0', '1'], ['24', '2021-02-25', '6', '0', '2', '6'], ['25', '2021-02-25', '3', '0', '0', '3'], ['26', '2021-02-25', '22', '2', '4', '13'], ['27', '2021-02-25', '14', '1', '2', '7'], ['28', '2021-02-25', '21', '3', '3', '16'], ['29', '2021-02-25', '1', '0', '0', '1'], ['2A', '2021-02-25', '2', '0', '0', '0'], ['2B', '2021-02-25', '0', '0', '1', '0'], ['30', '2021-02-25', '9', '1', '2', '11'], ['31', '2021-02-25', '19', '5', '2', '39'], ['32', '2021-02-25', '1', '1', '1', '20'], ['33', '2021-02-25', '9', '2', '6', '40'], ['34', '2021-02-25', '15', '5', '3', '8'], ['35', '2021-02-25', '15', '2', '3', '26'], ['36', '2021-02-25', '0', '0', '0', '0'], ['37', '2021-02-25', '17', '4', '0', '8'], ['38', '2021-02-25', '38', '6', '6', '28'], ['39', '2021-02-25', '2', '0', '0', '8'], ['40', '2021-02-25', '2', '0', '3', '4'], ['41', '2021-02-25', '18', '1', '7', '31'], ['42', '2021-02-25', '31', '10', '5', '31'], ['43', '2021-02-25', '2', '0', '1', '3'], ['44', '2021-02-25', '17', '2', '3', '27'], ['45', '2021-02-25', '13', '2', '4', '7'], ['46', '2021-02-25', '1', '1', '0', '0'], ['47', '2021-02-25', '0', '0', '0', '0'], ['48', '2021-02-25', '2', '0', '1', '5'], ['49', '2021-02-25', '9', '1', '3', '10'], ['50', '2021-02-25', '2', '0', '0', '4'], ['51', '2021-02-25', '8', '0', '1', '9'], ['52', '2021-02-25', '3', '0', '1', '5'], ['53', '2021-02-25', '7', '0', '0', '11'], ['54', '2021-02-25', '6', '4', '2', '9'], ['55', '2021-02-25', '5', '0', '2', '14'], ['56', '2021-02-25', '12', '2', '5', '9'], ['57', '2021-02-25', '55', '18', '14', '34'], ['58', '2021-02-25', '3', '0', '0', '5'], ['59', '2021-02-25', '84', '14', '8', '55'], ['60', '2021-02-25', '12', '5', '1', '23'], ['61', '2021-02-25', '3', '2', '2', '9'], ['62', '2021-02-25', '50', '11', '6', '40'], ['63', '2021-02-25', '5', '3', '6', '9'], ['64', '2021-02-25', '3', '1', '1', '5'], ['65', '2021-02-25', '11', '2', '0', '0'], ['66', '2021-02-25', '11', '1', '1', '3'], ['67', '2021-02-25', '15', '11', '0', '31'], ['68', '2021-02-25', '6', '1', '1', '18'], ['69', '2021-02-25', '53', '15', '11', '45'], ['70', '2021-02-25', '1', '1', '0', '5'], ['71', '2021-02-25', '12', '0', '3', '17'], ['72', '2021-02-25', '17', '0', '2', '8'], ['73', '2021-02-25', '2', '0', '0', '5'], ['74', '2021-02-25', '20', '2', '0', '18'], ['75', '2021-02-25', '68', '13', '14', '45'], ['76', '2021-02-25', '22', '4', '1', '17'], ['77', '2021-02-25', '21', '5', '9', '22'], ['78', '2021-02-25', '28', '2', '2', '21'], ['79', '2021-02-25', '4', '0', '0', '3'], ['80', '2021-02-25', '25', '5', '9', '21'], ['81', '2021-02-25', '4', '0', '0', '5'], ['82', '2021-02-25', '3', '2', '1', '4'], ['83', '2021-02-25', '49', '3', '10', '29'], ['84', '2021-02-25', '12', '2', '2', '12'], ['85', '2021-02-25', '4', '0', '0', '0'], ['86', '2021-02-25', '9', '2', '1', '14'], ['87', '2021-02-25', '1', '0', '0', '3'], ['88', '2021-02-25', '8', '3', '1', '15'], ['89', '2021-02-25', '10', '0', '1', '11'], ['90', '2021-02-25', '0', '0', '0', '0'], ['91', '2021-02-25', '32', '6', '6', '25'], ['92', '2021-02-25', '30', '13', '6', '40'], ['93', '2021-02-25', '34', '10', '1', '24'], ['94', '2021-02-25', '55', '14', '8', '45'], ['95', '2021-02-25', '33', '6', '5', '30'], ['971', '2021-02-25', '0', '0', '0', '2'], ['972', '2021-02-25', '0', '0', '0', '0'], ['973', '2021-02-25', '1', '0', '0', '3'], ['974', '2021-02-25', '8', '2', '0', '11'], ['976', '2021-02-25', '22', '3', '4', '3']]
        '''

        liste_date = []
        for i in range((dt.fromisoformat(self.date_fin) - dt.fromisoformat(self.date_debut)).days + 1):
            liste_date.append(str(dt.fromisoformat(self.date_debut) + timedelta(days=i)))
        new_data = [Table.column_names]
        for date in liste_date:
            for liste in Table.rows:
                if liste[self.index_date] == date:
                    new_data.append(liste)
        return Jeu_de_donnees(new_data)



